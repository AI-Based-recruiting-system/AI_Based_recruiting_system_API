// schema.prisma

generator client {
  provider   = "prisma-client-js"
  engineType = "binary"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum userStatus {
  INACTIVE
  ACTIVE
  DELETED
  BLOCKED
}

enum roleType {
  User
  ADMIN
  Recruiter
}

enum JobType {
  Full_time
  Part_time
  Contract
  Internship
}

enum ApplicationStatus {
  PENDING
  REJECTED
  INTERVIEW
  HIRED
}

model Users {
  id           String         @id @default(uuid()) @db.Uuid
  firstName    String
  lastName     String
  username     String         @unique
  phone        String         @unique
  roleId       String?         @db.Uuid
  role         Role?          @relation(fields: [roleId], references: [id])
  email        String         @unique
  password     String?
  status       userStatus
  avatar       String?
  deleted      Boolean        @default(false)
  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  deletedAt    DateTime?

  applications Application[]   // Relation: user → applications
}

model Role {
  id          String    @id @default(uuid()) @db.Uuid
  name        String    @unique
  description String?
  type        roleType
  permissions String[]
  users       Users[]   // Relation: role → users

  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt

  @@map("roles")
}

model Job {
  id                  String        @id @default(uuid()) @db.Uuid
  title               String
  description         String
  location            String
  type                JobType
  skillsRequired      String
  experiencedLevel    Int
  companyName         String
  salary              String
  applicationDeadline DateTime
  image               String?
  createdAt           DateTime      @default(now())
  updatedAt           DateTime      @updatedAt

  applications        Application[]  // Relation: job → applications
}

model Application {
  id        String    @id @default(uuid()) @db.Uuid

  user      Users     @relation(fields: [userId], references: [id])
  userId    String    @db.Uuid

  job       Job       @relation(fields: [jobId], references: [id])
  jobId     String    @db.Uuid

  appliedAt DateTime  @default(now())
  status    ApplicationStatus @default(PENDING)
  resumeUrl String?
  score     Float?

  @@unique([userId, jobId])
}
